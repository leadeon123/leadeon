if(window != top){alert("It's not allowed to include js/frame/frame.js in URL : \r\n" + window.location.href);}var Frame;if (Frame && (typeof Frame != "object" || Frame.name))throw new Error("Namespace 'Frame' already exists");(function(){Frame = new Namespace();var memory = [];var tabid = null;var urlMapTabId = [];var tabflag = [];var timeout = null;var aNameSpace = [Frame];var aFnOnload = [];var aFnOnUnload = [];Frame.save = save;Frame.load = load;Frame.clear = clear;Frame.init = init;Frame.onStartUp = onInit; Frame.onDesdroy = onDesdroy;Frame.getExceeds = getExceeds;Frame.addTabControl = addTabControl;Frame.gotoTabPage = gotoTabPage;Frame.redirectTabById = redirectTabById;Frame.doTabAction = doTabAction;Frame.CUSTOMTCACTION = "CUSTOMTCACTION";Frame.clearFrameTimeout = clearFrameTimeout;Frame.updateFrameTimeout = updateFrameTimeout;Frame.regOnload =function(fnOnload){aFnOnload.push(fnOnload);};Frame.regOnUnload =function(fnOnUnload){aFnOnUnload.push(fnOnUnload);};superString(window);function Namespace(){this.regNamespace = function(sName){if(sName in this){throw new Error("Namespace '" + sName + "' already exists");return;}this[sName] = new Namespace();return this[sName];}}function init(win){win["cos"] = cos(win);win["Frame"] = Frame;updateFrameTimeout();for(var i=0; i<aFnOnload.length;i++){try{aFnOnload[i]();}catch(e){};}}function onInit(win){ if("mainframe" == win.name && win.parent.parent == top){addTabControl(win);top.PubActiveWindow = win;try{var oTree = top.MenuWindow.g_oTree;var oItem = oTree.GetItem(g_sCurTabId);oItem.Expand("open");} catch(e1){}try{var oErrInfo = win.document.getElementById("ErrInfo");var sErrInfo = oErrInfo.innerHTML;alert(sErrInfo);if(win.OnDisplayError) {return win.OnDisplayError();}} catch(e){}}}function onDesdroy(win){if("mainframe" == win.name){top.PubActiveWindow = null;}        }function superString(win){with(win){String.prototype.byteLength=function(){return this.replace(/[^\x00-\xff]/g,"**").length;}String.prototype.paddingString=function(len,pad){var tmp;var i;tmp = "";for (i=this.byteLength(); i<len; i++)tmp+=pad;return this.toString() + tmp;}String.prototype.trim = function ( ){var str = this;str = str.replace(/^\s*/, "");str = str.replace(/\s*$/, "");return str;}String.prototype.isNumber = function ( ){var i;for(i = 0; i < this.length; i++){var c = this.charCodeAt(i);if(c < 48 || c > 57){return false;}}return i>0;}String.prototype.toInnerText = function ( ){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;/g,"&");}String.prototype.parseUnicode = function (){var index,res,start,end,str;index = 0;res = "";str = this;while (index < str.length){start = str.indexOf("&#", index);if (start == -1){res += str.substr(index);return res;}end = str.indexOf(";", start);if (end == -1){res += str.substr(index);return res;}res += str.substring(index, start);unicode = str.substring(start+2, end);if (unicode.isNumber()){res += String.fromCharCode(unicode);}else{res += str.substring(start, end+1);}index = end + 1;}return res;}String.prototype.parseCharEntity = function (){var oPatten = /([\u4e00-\u9fa5])/;var res = this,cTemp;while(oPatten.test(res) == true){res = res.replace(oPatten,"&#[$1];");cTemp = res.replace(/.*&#\[(.*)\];.*/,"$1");res = res.replace(/&#\[.*\];/,"&#" + cTemp.charCodeAt(0) + ";");}return res;}}}function getExceeds(aBase, aCurrent){aResult = [];for(var i in aCurrent){if(!include(aBase, aCurrent[i])) aResult.push(aCurrent[i]);}return aResult;function include(arr, item){for(var i in arr){if(item == arr[i]) return true;}return false;}}function save(paraName,paraValue){if("string" == typeof(paraName).toLowerCase()){memory[paraName] = paraValue;return paraValue;}alert("paraName is not a string.");}function load(paraName){if("string" == typeof(paraName).toLowerCase()){return memory[paraName];}alert("paraName is not a string.");}function clear(){for(var o in memory){delete memory[o];}}function gotoTabPage(win, nPage){var TABID = win.TABID||tabid||urlMapTabId[win.location.href];var aTabPage = top.Frame.load("Frame_TabControl");var bRet = false;if( aTabPage && TABID && aTabPage[TABID] && null != win.document.getElementById("DIV_TABCONTROL")){if(1<= nPage && aTabPage[TABID].length >= aTabPage[TABID].length){top.doAction(win, aTabPage[TABID][nPage-1].action);bRet = true;}else if(-1 == nPage){for(var i = 0; i< aTabPage[TABID].length;i++){if(aTabPage[TABID][i].id == TABID){top.doAction(win, aTabPage[TABID][i].action);bRet = true;break;}}}}return bRet;}function redirectTabById(win, TABID){var aTabPage = top.Frame.load("Frame_TabControl");var sRet = null;if( aTabPage && TABID && aTabPage[TABID]){for(var i = 0; i< aTabPage[TABID].length;i++){if(aTabPage[TABID][i].id == TABID){top.doAction(win, aTabPage[TABID][i].action);sRet = aTabPage[TABID][0].id;break;}}}tabid = TABID;return sRet;}function addTabControl(win){var TABID = win.TABID||tabid||urlMapTabId[win.location.href];        urlMapTabId[win.location.href] = TABID; var aTabPage = top.Frame.load("Frame_TabControl");if( aTabPage && TABID && aTabPage[TABID] && null == win.document.getElementById("DIV_TABCONTROL")){var sDivInner = '<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr>';for(var i = 0; i< aTabPage[TABID].length;i++){sDivInner += addTabItem(aTabPage[TABID][i].name, aTabPage[TABID][i].action, aTabPage[TABID][i].id, TABID);}sDivInner += '<td valign="bottom" class="tab_text">&nbsp;</td></tr></table>';var sTabHtml = "<div id='DIV_TABCONTROL' class='tab_frame'>" + sDivInner + "</div>";var oBody = win.document.getElementById ("tab_container");if(null == oBody){oBody = win.document.body;if(win.name == "mainframe"){oBody.innerHTML = "<div id='BODY'>" + sTabHtml + "<div id='INNER'>" + oBody.innerHTML + "</div></div>";}else{oBody.innerHTML = sTabHtml + oBody.innerHTML;}}else{oBody.innerHTML = sTabHtml;}if(null == win.TABID && null == win.OnSubmitRedirect) win.OnSubmitRedirect = function(){gotoTabPage(win, -1);}if(null == win.TABID && null == win.OnSubmitError) win.OnSubmitError = function(){gotoTabPage(win, -1);}}tabid = null;}function doTabAction(win, id, action){tabid = id;if(action == Frame.CUSTOMTCACTION) top.Frame.load("Frame_TabControl")[id].func();else top.doMenuAction(win, action);}function addTabItem(name, action, id, curId){var sr = id==curId?'cur':'nr';var sTd = '<td width="1" class="tab_left_' + sr + '">&nbsp;</td>';sTd+= '<td class="tab_content_' + sr + '" width="40" onclick="top.Frame.doTabAction(window,&quot;' + id +'&quot;,&quot;' + action +'&quot;)"><nobr>'+name+'</nobr></td>';sTd+= '<td width="1" class="tab_right_' + sr + '">&nbsp;</td>';return sTd;}function clearFrameTimeout(){if (null != timeout){clearTimeout(timeout);}timeout = null;}function updateFrameTimeout(){if (undefined == top.g_nTimeout ||"" == top.g_nTimeout){top.g_nTimeout = 10;}clearFrameTimeout();timeout = setTimeout("top.location='/'", 60000*top.g_nTimeout);}})();(function(){var Ajax = {};if ("Ajax" in Frame) throw new Error("Namespace 'Frame.Ajax' already exists");Frame.Ajax = Ajax;Ajax.send = send; Ajax.sendCmd = sendCmd; function parseUrlPara(urlPara){var sUrlPara = "uid=" + top.WnmGetUID();switch(Frame.Util.getType(urlPara)){case "null":{break;}case "Function":{sUrlPara += "&" + urlPara().toString();break;}case "Object":{if("Function" == Frame.Util.getType(urlPara.toUrlParaString)){sUrlPara += "&" + urlPara.toUrlParaString();break;}for(var sItem in urlPara){var itemValue = urlPara[sItem];switch(Frame.Util.getType(itemValue)){case "null":{sUrlPara += "&" + sItem + "="; break;}case "Function":{sUrlPara += "&" + sItem + "=" + itemValue();break;}case "Array":{for(var i=0; i< itemValue.length; i++){sUrlPara += "&" + sItem + "=" + itemValue[i].toString();}break;}default:{sUrlPara += "&" + sItem + "=" + itemValue.toString();break;}}}break;}default:{sUrlPara += "&" + urlPara.toString();break;}}return sUrlPara;}function XMLHTTP(){/*@cc_on@if (@_jscript)var xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");@else*/var xmlhttp = new XMLHttpRequest();/*@end@*/this.onreadystatechange = null;var oThis = this;xmlhttp.onreadystatechange = function(){oThis.readyState = xmlhttp.readyState;if(oThis.readyState == 4){oThis.responseXML = xmlhttp.responseXML;oThis.status = xmlhttp.status;oThis.statusText = xmlhttp.statusText;oThis.responseText = xmlhttp.responseText;oThis.responseBody = xmlhttp.responseBody;oThis.responseStream = xmlhttp.responseStream;}else{oThis.responseXML = "";oThis.status = 0;oThis.statusText = "";oThis.responseText = "";oThis.responseBody = [];oThis.responseStream = [];}oThis.onreadystatechange();}this.open = function(bstrMethod, bstrUrl, varAsync, bstrUser, bstrPassword){return xmlhttp.open(bstrMethod, bstrUrl, varAsync, bstrUser, bstrPassword);}this.send = function(varBody){   return xmlhttp.send(varBody);}this.getResponseHeader = function(bstrHeader){   return xmlhttp.getResponseHeader(bstrHeader);}this.getAllResponseHeaders = function(){   return xmlhttp.getAllResponseHeaders();}this.abort = function(){this.onreadystatechange = function(){};return xmlhttp.abort();}this.free = function(){xmlhttp = null;}}function send(sUrl, oUrlPara, fnCallBack, oOption ){if(!sUrl){return null;}; var option = {bAsync:true, nTimeOut:null, bChkErr:(null != fnCallBack), bShowErr:true, bProcErr:false};for(var i in oOption) option[i] = oOption[i];var aPara = []; for(var i=4; i< arguments.length; i++){aPara.push(arguments[i]);};var xmlhttp = new XMLHTTP(); xmlhttp.timeout = false; xmlhttp.success = true; xmlhttp.message = ""; var hTimer = null;xmlhttp.onreadystatechange = function(){if(4 != xmlhttp.readyState) return; if(null !== hTimer) {clearTimeout(hTimer);hTimer = null;}if(200 != xmlhttp.status  && 0 != xmlhttp.status ) {xmlhttp.success = false; }else if("text/xml" == xmlhttp.getResponseHeader("Content-Type")) {var xmldoc = xmlhttp.responseXML, ErrorMsg;try{ErrorMsg = (xmldoc.selectSingleNode("//ErrorMsg/item/message")||xmldoc.selectSingleNode("//ErrorMsg")).text;}catch(e){ErrorMsg="";}try{if(1 == parseInt(xmldoc.selectSingleNode("//BackHome").text)){if("" != ErrorMsg){alert(ErrorMsg);};top.location = "/";return;}}catch(e){}if(false !== option.bChkErr){xmlhttp.message = ErrorMsg;try{xmlhttp.success = (0 === parseInt(xmldoc.selectSingleNode("//ErrorId").text));}catch(e){xmlhttp.success=("" == ErrorMsg)}}if( false !== option.bShowErr && !xmlhttp.success && "" != xmlhttp.message){alert(xmlhttp.message);}}if(option.bProcErr || xmlhttp.success) {   try{fnCallBack.apply(xmlhttp, aPara);}catch(e){}; }xmlhttp.free();xmlhttp = null;}try{xmlhttp.open("post", sUrl, option.bAsync);xmlhttp.send(parseUrlPara(oUrlPara));if(!isNaN(parseInt(option.nTimeOut))){hTimer = setTimeout(function(){try{xmlhttp.abort();xmlhttp.timeout = true;hTimer = null;try{fnCallBack.apply(xmlhttp, aPara);}catch(e){}; xmlhttp = null; }catch(e){}}, parseInt(option.nTimeOut));}}catch(e){xmlhttp.success = "not-support";if(null != fnCallBack && "function" == typeof(fnCallBack)){fnCallBack.apply(xmlhttp, aPara);}xmlhttp = null;}return xmlhttp;}function sendCmd(sCmdMode, sCmdWord, fnCallBack){return send("/wcn/frame/command", {cmdmode:sCmdMode, cmdword:sCmdWord}, sendCB, {bChkErr:false});function sendCB(){if(top.WnmGetLevel() < 3 || this.responseText != "OK") this.success = false;if(fnCallBack && "function" == typeof(fnCallBack)) fnCallBack.apply(this);}}function sendCmdAndGetResponse(){}})();(function(){var Form = {};if ("Form" in Frame) throw new Error("Namespace 'Frame.Form' already exists");Frame.Form = Form;function post(sUrl, urlPara, target){    var oForm = document.createElement("form");oForm.method = "POST";if(null == target || "string" != typeof(target)) target = top.FrmSubmit.name;oForm.target = target;if(!("uid" in urlPara)) urlPara.uid = top.WnmGetUID();for(var i in urlPara){var oInput = document.createElement("input");oInput.type = "text";oInput.name = i;oInput.value = urlPara[i];oForm.appendChild(oInput);}oForm.submit()}function send(sUrl, urlPara, target, method){    if(null == method || "string" != typeof(method)) post(sUrl, urlPara, target);}})();(function(){var Menu = {};if ("Menu" in Frame) throw new Error("Namespace 'Frame.Menu' already exists");Frame.Menu = Menu;function getPathById(TABID){return MenuWindow.g_oTreeRoot.GetFullMenuPath(TABID);}Menu.getPathById = getPathById;})();(function(){var aLogs = []; var aOutputs = []; var nOutputId = 0; function output(){for(var i=0; i<aOutputs.length; i++){setTimeout(aOutputs[i].output, 0);}}function Log(sMessage, sType, sSource){this.time = new Date();this.type = sType; this.source = sSource; this.message = sMessage;aLogs.push(this);output();}function Output(fnOutput){var current = 0, oOutput=this;aOutputs.push(this);this.name = "日志输出通道" + nOutputId++;this.output = function(){try{while(aLogs[current]){fnOutput(aLogs[current++]);}}catch (e) {fnOutput = function(){}log("输出日志时发生错误: " + (e.description||e.message) + "，即将删除" + oOutput.name, "error", "log");var bSuccess = removeOutput(oOutput);}}this.output();}function log(sMessage, sType, sSource) {new Log(sMessage||"No message.", sType||"info", sSource||"global");}function addOutput(fnOutput){var oOutput = new Output(fnOutput);log(oOutput.name + "已创建，日志输出启动。", "info", "log");return oOutput;}function removeOutput(oOutput) {var bFound = false;for(var i=0; i < aOutputs.length; i++){if(aOutputs[i] == oOutput){bFound = true;break;}}if(bFound){aOutputs.splice(i, 1);log(oOutput.name + "删除成功。", "info", "log");}else{log(oOutput.name + "删除失败。", "error", "log");}return bFound;}log.addOutput = addOutput;log.removeOutput = removeOutput;if ("log" in Frame){throw new Error("Namespace 'Frame.log' already exists");}Frame.log = log;log("日志中心启动成功。", "info", "log");})();(function(){var EventHandler = {};if ("EventHandler" in Frame) throw new Error("Namespace 'Frame.EventHandler' already exists");Frame.EventHandler = EventHandler;if(document.addEventListener){EventHandler.add = function(element, eventType, handler){element.addEventListener(eventType, handler, false);};EventHandler.remove = function(element, eventType, handler){element.removeEventListener(eventType, handler, false);};}else if(document.attachEvent){EventHandler.add = function(element, eventType, handler){if(EventHandler._find(element, eventType, handler) != -1) return;var wrappedHandler = function(e){if(!e){var win = Frame.Util.getWindowByElement(element);e = win.event;}var event = {_event:e,type:e.type,target:e.srcElement,currentTarget:element,relatedTarget:e.fromElement?e.fromElement:e.toElement,eventPhase: (e.srcElement==element)?2:3,clientX:e.clientX,clientY:e.clientY,screenX:e.screenX,screenY:e.screenY,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey, charCode:e.keyCode,stopPropagation:function(){this._event.cancelBubble = true;},preventDefault:function(){this._event.returnValue = false;}};if(Function.prototype.call){handler.call(element, event);}else{element._currentHandler = handler;element._currentHandler(event);element._currentHandler = null;}}element.attachEvent("on" + eventType, wrappedHandler);var h = {element:element,eventType:eventType,handler:handler,wrappedHandler:wrappedHandler};var d = element.document || element;var w = d.parentWindow;var id = EventHandler._uid();if(!w._allHandlers) w._allHandlers = {};w._allHandlers[id] = h;if(!element._handlers) element._handlers = [];element._handlers.push(id);if(!w._onunloadHandlerRegistered){w._onunloadHandlerRegistered = true;w.attachEvent("onunload", EventHandler._removeAllHandlers);                }};EventHandler.remove = function(element, eventType, handler){var i = EventHandler._find(element, eventType, handler);if( i== -1) return;var d = element.document || element;var w = d.parentWindow;var handlerId = element._handlers[i];var h = w._allHandlers[handlerId];element.detachEvent("on" + eventType, h.wrappedHandler);element._handlers.splice(i, 1);delete w._allHandlers[handlerId];};EventHandler._find = function(element, eventType, handler){var handlers = element._handlers;if(!handlers) return -1;var d = element.document || element;var w = d.parentWindow;for(var i=handlers.length-1; i>=0; i--){var handlerId = handlers[i];var h = w._allHandlers[handlerId];if(h.eventType == eventType && h.handler == handler)return i;}return -1;};EventHandler._removeAllHandlers = function(){var w = this;for(id in w._allHandlers){var h = w._allHandlers[id];h.element.detachEvent("on" + h.eventType, h.wrappedHandler);delete w._allHandlers[id];}}EventHandler._counter = 0;EventHandler._uid = function(){return "h" + EventHandler._counter++;};}})();(function(){var Util = Frame.regNamespace("Util");function DragDom(oElementToDrag, oElementTriger){if(!oElementToDrag) return;if(!oElementTriger) oElementTriger = oElementToDrag;var nCornerSize = oElementTriger.offsetHeight;var win = getWindowByElement(oElementToDrag);var winDoc = win.document;oElementToDrag.style.position = "absolute";oElementTriger.onmousedown = downHandler;function downHandler(myEvent){if(!myEvent) myEvent = win.event;var startX = myEvent.clientX, startY = myEvent.clientY;var origX = oElementToDrag.offsetLeft, origY = oElementToDrag.offsetTop;var deltaX = startX + winDoc.body.scrollLeft - origX, deltaY = startY + winDoc.body.scrollTop - origY;if(oElementToDrag.setCapture){oElementToDrag.setCapture();}winDoc.onmousemove = moveHandler;winDoc.onmouseup = upHandler;function moveHandler(e){if(!e) e = win.event;var x = e.clientX + winDoc.body.scrollLeft - deltaX;var y = e.clientY + winDoc.body.scrollTop - deltaY;if(x < nCornerSize - oElementToDrag.offsetWidth) x = (nCornerSize - oElementToDrag.offsetWidth);if(x > (winDoc.body.clientWidth - nCornerSize)) x = (winDoc.body.clientWidth - nCornerSize);if(y < 0) y = 0;if(y > (winDoc.body.clientHeight - nCornerSize)) y = (winDoc.body.clientHeight - nCornerSize);oElementToDrag.style.left = x + "px";oElementToDrag.style.top = y + "px";}function upHandler(e){if(!e) e = win.event;if(oElementToDrag.releaseCapture){oElementToDrag.releaseCapture();}winDoc.onmousemove = null;winDoc.onmouseup = null;}}}function FloatDiv(oWin){var oDiv = null;var oContent = null;var oIframeShim = null;var oDrag = null;var oWinDisplay = window;if(oWin) oWinDisplay = oWin;this.setAttribute = function(oAttr){if(oAttr){for(var key in oAttr){oDiv.setAttribute(key,oAttr[key]);}}_Refresh();};this.getAttribute = function(name){if(oDiv[name] == null) return oDiv.getAttribute("name"); else return oDiv[name];};this.setStyle = function(oStyle){if(oStyle){for(var key in oStyle){oDiv.style[key] = oStyle[key];}}_Refresh();};this.getStyle = function(name){return oDiv.style[name]};this.appendChild = function(oEle){oContent.appendChild(oEle);_Refresh();};this.removeChild = function(oEle){oContent.removeChild(oEle);_Refresh();};this.insertBefore = function(oEle,oChild){oContent.insertBefore(oEle,oChild);_Refresh();};this.contains = function(oEle){return contains(oContent,oEle)};this.show = function(){oWinDisplay.document.body.appendChild(oDiv);_Refresh();};this.hide = function(){oWinDisplay.document.body.removeChild(oDiv);};this.enableDrag = function(oEle){oDrag = new DragDom(oDiv,oEle);};function _FloatDiv(){if(arguments[0]) oWinDisplay = arguments[0];oDiv = createElement(oWinDisplay,"div",null,{zIndex:'95',backgroundColor:'#ffffff',position:'absolute',overflow:'hidden'});oContent = createElement(oWinDisplay,"div",null,{left:'0px',top:'0px',position:'relative',overflow:'hidden'});oDiv.appendChild(oContent);if("IE" == Frame.RunState.Navigator.Type){oIframeShim = createElement(oWinDisplay,"iframe",{frameBorder:'0',src:'/html/empty.html'},{position:'absolute',left:'0px',top:'0px',width:oContent.offsetWidth + "px",height:oContent.offsetHeight + "px",margin:'0px',padding:'0px'});oDiv.insertBefore(oIframeShim,oContent);}}function _Refresh(){oContent.style.width = "";oContent.style.width = oContent.offsetWidth + "px";if(oIframeShim){oIframeShim.style.width = oContent.offsetWidth + "px";oIframeShim.style.height = oContent.offsetHeight + "px";}}_FloatDiv.apply(this,arguments);}function Cover(){var oExcept = null;this.show = ShowCover;this.hide = HideCover;function ShowCover(oEle){oExcept = oEle;_SetCoverVisibility(top,true);_SetCoverVisibility(top.MenuWindow,true);_DisposeWindow(top.GetCtrlWindow(),true);top.EventHandler.regEvent("resize","cover",function(oWin){if(oWin.document){var oCover = oWin.document.getElementById("FLOATWIN_INNERCOVER");if(oCover){RefreshCover(oWin,oCover);}}});}function HideCover(){_SetCoverVisibility(top,false);_SetCoverVisibility(top.MenuWindow,false);_DisposeWindow(top.GetCtrlWindow(),false);top.EventHandler.unregEvent("resize","cover");}function _DisposeWindow(oWin,bVisible){/*@cc_on@if (@_jscript)@else*/if(oWin != window.GetCtrlWindow())/*@end@*/{for(var i = 0; i < oWin.frames.length; i++){_DisposeWindow(oWin.frames[i],bVisible);}}_SetCoverVisibility(oWin,bVisible);}function _SetCoverVisibility(oWin,bVisible){var oCover;if(oWin.document && oWin.document.body){if(bVisible){oCover = oWin.document.getElementById("FLOATWIN_INNERCOVER");if(!oCover){oCover = createElement(oWin,"div",{id:'FLOATWIN_INNERCOVER'},{backgroundColor:'#000000',position:'absolute',zIndex:'80'});oWin.document.body.appendChild(oCover);}_SetCoverStyle(oWin,oCover);oCover.style.visibility = "visible";/*@cc_on@if (@_jscript)oCover.style.filter = "alpha(opacity = 0)";oCover.filters.alpha.opacity = 12;_DisableSelects(oWin);@else*/oCover.style.opacity = 0.12;/*@end@*/}else{oCover = oWin.document.getElementById("FLOATWIN_INNERCOVER");if(oCover){oCover.style.visibility = "hidden";oCover.style.width = "0px";oCover.style.height = "0px";oCover = null;}/*@cc_on@if (@_jscript)_RestoreSelects(oWin);@else*//*@end@*/}}}function _SetCoverStyle(oWin,oCover){oCover.style.width = (oWin.document.body.scrollWidth - oWin.document.body.offsetLeft) + 'px';if(oWin == top){oCover.style.height = (getOffsetTop(top.document.getElementById("Frame_Content"))) + 'px';}else{var nHeight = Math.max(oWin.document.body.scrollHeight,oWin.document.body.clientHeight);oCover.style.height = (nHeight - oWin.document.body.offsetTop) + 'px';}oCover.style.left = oWin.document.body.offsetLeft + 'px';oCover.style.top = oWin.document.body.offsetTop + 'px';}function _DisableSelects(win){var doc = win.document;var oSelects = doc.getElementsByTagName("select");var oSelect,newNode;for ( var i=0; i<oSelects.length; i++ ){oSelect = oSelects[i];if(!oExcept || !contains(oExcept,oSelect)){if(oSelect.multiple == true){oSelect.pdisabled = oSelect.style.visibility;oSelect.style.visibility = "hidden";continue;}if(oSelect.selectedIndex >= 0){newNode = createElement(win,"span",null,{fontSize:'12px'});newNode.innerHTML = oSelect.options[oSelect.selectedIndex].text;oSelect.parentNode.insertBefore(newNode,oSelect);oSelect.tempNode = newNode;}oSelect.pdisabled = oSelect.style.display;oSelect.style.display = "none";}    }}function _RestoreSelects(win){var doc = win.document;var oSelects = doc.getElementsByTagName("select");var oSelect;for ( var i=0; i<oSelects.length; i++ ){oSelect = oSelects[i];if(!oExcept || !contains(oExcept,oSelect)){if(oSelect.multiple == true){oSelect.style.visibility = oSelect.pdisabled;continue;}if(oSelect.tempNode){oSelect.tempNode.removeNode(true);oSelect.tempNode = null;}if(oSelect.pdisabled != null){oSelect.style.display = oSelect.pdisabled;}var nWidth = parseInt(oSelect.offsetWidth);oSelect.style.width = (nWidth + 1) + "px";function adjust(nWidth){return function(){oSelect.style.width = nWidth + "px";}}setTimeout(adjust(nWidth),0);}}}function RefreshCover(oWin,oCover){oCover.style.width = oWin.document.body.clientWidth;oCover.style.height = oWin.document.body.clientHeight;window.setTimeout(function(){oCover.style.width = (oWin.document.body.scrollWidth - oWin.document.body.offsetLeft) + 'px';if(oWin == top){oCover.style.height = (getOffsetTop(top.document.getElementById("Frame_Content"))) + 'px';}else{var nHeight = Math.max(oWin.document.body.scrollHeight,oWin.document.body.clientHeight);oCover.style.height = (nHeight - oWin.document.body.offsetTop) + 'px';}},100);}}function getWindowByElement(oElement){/*@cc_on@if (@_jscript)return oElement.ownerDocument.parentWindow;@else*/return oElement.ownerDocument.defaultView;/*@end@*/}function getOffsetTop(obj,win){if(!obj) return;if(!win) win = getWindowByElement(obj);var nTop = 0;while(obj){nTop += obj.offsetTop;if(obj.tagName.toLowerCase() == "body" && getWindowByElement(obj) != win){obj = getWindowByElement(obj).frameElement;}else{obj = obj.offsetParent;}}return nTop;}function getOffsetLeft(obj,win){if(!obj) return;if(!win) win = getWindowByElement(obj);var nLeft = 0;while(obj){nLeft += obj.offsetLeft;if(obj.tagName.toLowerCase() == "body" && getWindowByElement(obj) != win){obj = getWindowByElement(obj).frameElement;}else{obj = obj.offsetParent;}}return nLeft;}function Tip(){var eSrc = null;var ePanel = null;var x,y;this.setPosition = setPosition;function setPosition(posX,posY){x = posX;y = posY;}this.show = show;function show(elem,str){if(!elem) return;if(ePanel) hide();var oWin = getWindowByElement(elem);ePanel = new FloatDiv(oWin);var eInfo = createElement(oWin,"div",null,{backgroundColor:'#FFFFE1',padding:'2px',fontSize:'12px',border:'solid 1px black'});eInfo.innerHTML = str;ePanel.appendChild(eInfo);if(!x) x = getOffsetLeft(elem);if(!y) y = getOffsetTop(elem) + elem.offsetHeight;ePanel.setStyle({left:x + 'px',top:y + 'px'});ePanel.show();}this.hide = hide;function hide(){if(ePanel){ePanel.hide();ePanel = null;}}}function createElement(oWin,sTagName,oAttribute,oStyle,sText){if(!oWin){oWin = window.self;}/*@cc_on@if (@_jscript)if(sTagName.toLowerCase() == "input" && oAttribute["type"] && oAttribute["type"].toLowerCase() == "radio"){var sTagName = "<input type='radio' ";if(oAttribute["name"]) sTagName += ("name='" + oAttribute["name"] + "' ");if(oAttribute["checked"]) sTagName += ("checked='" + oAttribute["checked"]);sTagName += ">";}@else*//*@end@*/var oEle = oWin.document.createElement(sTagName);if(oAttribute){for(var key in oAttribute){if(oAttribute[key] == undefined || oAttribute[key] == null) continue;switch(key){/*@cc_on@if (@_jscript)case 'name':@else*//*@end@*/case 'text':case 'value':case 'className':case 'size':oEle[key] = oAttribute[key];default:oEle.setAttribute(key,oAttribute[key]);break;}}}if(oStyle){for(var key in oStyle)oEle.style[key] = oStyle[key];}if (sText){var oText = oWin.document.createTextNode(sText);oEle.appendChild(oText);}return oEle;}function createImage(oWin,oAttribute){if(!oWin){oWin = window.self;}var width,height,src;var oEle = oWin.document.createElement("img");oEle.style.display = "none";if(oAttribute){for(var key in oAttribute){if(oAttribute[key] == undefined || oAttribute[key] == null) continue;switch(key){case 'src':src = oAttribute[key];var monitor = new Monitor(function(){if(contains(oWin.document.body,oEle)){return true;}return false;},function(src){oEle.style.display = "";oEle.src = src;},{win:oWin,args:[src]});monitor.start();break;default:oEle.setAttribute(key,oAttribute[key]);break;}}}return oEle;}function bindEvent(objDes,sEventList,pfCallback){if(typeof(sEventList) != "string"){return false;}var arrEvent = sEventList.split(",");var arrCallback = [],pTemp,sEvent,nParamPos = 2,sFunc;for(var i = 0; i < arrEvent.length; i++){if(Object.prototype.toString.apply(arguments[i + 2]) == "[object Function]"){arrCallback[i] = arguments[i + 2];nParamPos++;}                }var args = $A(arguments).slice(nParamPos);var lenArgs = args.length;for(var i = 0; i < arrCallback.length; i++){sEvent = arrEvent[i].replace(/^(on)?([a-zA-Z]*)$/,"on$2");pTemp = function(){var __pSelf = this;this.pfCallback = arrCallback[i];this.args = args;return function(ev){if(!ev){var oWin = objDes;if(objDes.write) oWin = objDes.parentWindow ? objDes.parentWindow : objDes.defaultView;if(objDes.ownerDocument) oWin = Util.getWindowByElement(objDes);ev = oWin.event;}__pSelf.args[lenArgs] = ev;return __pSelf.pfCallback.apply(__pSelf,__pSelf.args);}}objDes[sEvent + "Param"] = {};objDes[sEvent] = pTemp.apply(objDes[sEvent + "Param"]);}function $A(iterable){if(!iterable)return [];if(iterable.toArray){return iterable.toArray();}else{var results = [];for (var i = 0, length = iterable.length; i < length; i++)results.push(iterable[i]);return results;}}}function contains(oParent,oChild){/*@cc_on@if (@_jscript)return oParent.contains(oChild);@else*/var oNode = oChild;while(oNode){if(oNode.parentNode == oParent){return true;}oNode = oNode.parentNode;}return false;/*@end@*/}function getType(x){if(null == x) return "null";return Object.prototype.toString.apply(x).replace(/^\[object (.*?)\]$/,"$1");}function IpStr2Integer(sIp){try{var arr = sIp.split(".");var nIp = 0;var nTemp;if(4 != arr.length){return 0;}for(var i=0; i<4; i++){nTemp = parseInt(arr[i]);if(nTemp > 255 || nTemp < 0){return 0;}nIp = nIp*0x100 + nTemp;}return nIp;}catch(e){return 0;}}function portToString(s){var sRet = "";var sIfType = s.replace(/^([^0-9]*)\S*/,"$1");var sIfnumber = s.replace(/^[^0-9]*(\S*)/,"$1");var arrTemp = sIfnumber.split("/");var nLen = arrTemp.length-1;sRet = sIfType;for(var i=0; i<nLen; i++){sRet += makeFixLen("0000",arrTemp[i]);}var arr = arrTemp[i].split(".");if(1 == arr.length) arr = arrTemp[i].split(":");sRet += makeFixLen("0000",arr[0]);if(arr.length > 1){sRet += makeFixLen("0000",arr[1]);}return sRet;}function makeFixLen(sPre, sNumber){var s1 = sPre + sNumber;var nLen = sPre.length;return s1.substring(s1.length - nLen);}var cookie = {read : function(key){var doc = window.document;var patten = new RegExp("(?:^|; )" + key + "=(.*?)(?:;|$)");var result = doc.cookie.match(patten);return result == null ? "" : result[1];},write : function(key,value,option){var cookie = key + "=" + value;var doc = window.document;if(option){var date = new Date();var bExpires = false;for(var item in option){switch(item){case "path":case "domain":case "expires":cookie += ("; " + item + "=" + option[item]);break;case "y":date.setFullYear(date.getFullYear() + option[item]);bExpires = true;break;case "M":date.setMonth(date.getMonth() + option[item]);bExpires = true;break;case "d":date.setDate(date.getDate() + option[item]);bExpires = true;break;case "h":date.setHours(date.getHours() + option[item]);bExpires = true;break;case "m":date.setMinutes(date.getMinutes() + option[item]);bExpires = true;break;case "s":date.setSeconds(date.getSeconds() + option[item]);bExpires = true;break;default:break;}}if(bExpires)cookie += ("; expires=" + date.toGMTString());}doc.cookie = cookie;},remove:function(key,options){if(!options)options = {};options.expires = (new Date()).toGMTString();this.write(key,key,options);},isSupport : function(){var str = "check";this.write(str,str);var ret = (str == this.read(str));this.write(str,str,{expires:(new Date()).toGMTString()});return ret;}}function Dot(dom,text,options){var timer = null;var counter = 0;var dots = null;var htmlCode = null;var _options = options || {};var dotBuffer = [];var loop = 3;var freq = 1000;var onstop = function(){dom.innerHTML = htmlCode;};if(_options.loop != null)loop = _options.loop;if(_options.freq != null)freq = _options.freq;if(_options.onstop != null)onstop = _options.onstop;this.play = function(){htmlCode = dom.innerHTML;timer = setInterval(function(){var dotCount = ((counter++) % loop);if(dotCount == 0)dotBuffer = [];dotBuffer.push(".");dom.innerHTML = text + dotBuffer.join("");},freq);};this.stop = function(){if(timer){clearInterval(timer);timer = null;}onstop.apply(null,[htmlCode]);};}var JSON = {getObject:function(str){eval("var obj = " + str);return obj;},serialize:function(obj){var str;if(obj === null)str = "null";else if(obj === undefined) str = "undefined";else{var buf = ["{"];for(var key in obj){buf.push(key + ":\"" + (obj[key] + "").replace(/"/g,"\\\""));buf.push("\",");}str = buf.join("");str = str.replace(/[,]$/,"}");}return str;}};function Monitor(fnCondition,fnCallback,options){var monitor = null;var _this = this;var freq = 100;var win = window;var args = [];var timeout = 30000;if(options){for(var key in options){switch(key){case "freq":freq = options[key];break;case "win":win = options[key];break;case "args":args = options[key];break;case "timeout":timeout = options[key];break;default:break;}}}this.start = function(){if(monitor == null){monitor = win.setInterval(function(){if(fnCondition.apply()){fnCallback.apply(null,args);_this.stop();}},freq);win.setTimeout(this.stop,timeout);}};this.stop = function(){if(monitor){win.clearInterval(monitor);monitor = null;}};}(function(){var aSeriateMask = [];for(var i = 0; i<=32; i++){aSeriateMask[maskLenToString(i)] = maskLenToNumber(i);}function isDottedQuad(sDottedQuad){if(!(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(sDottedQuad))){return false;}var aDottedQuad = sDottedQuad.split(".");for(var i=0; i<aDottedQuad.length;i++){if(parseInt(aDottedQuad[i],10)>255){return false;}}return true;}function dottedQuadToNumber(sDottedQuad) {var nReturn = 0;var aDottedQuad = sDottedQuad.split(".");for(var i = 0; i < 4; i++) {nReturn += parseInt(aDottedQuad[i],10)*Math.pow(2, 8*(3-i));}return nReturn;}function maskLenToNumber(sMaskLen){var nMask = 0;nMaskLen = parseInt(sMaskLen, 10);              				for(var i = 1; i <= nMaskLen; i++){nMask += Math.pow(2,32-i);}return nMask;}function maskLenToString(sMaskLen){var sMask = "";var nMask = maskLenToNumber(sMaskLen);for(var i = 0; i < 4; i++){sMask += Math.floor(nMask%Math.pow(2,8*(4-i))/Math.pow(2,8*(3-i))).toString(10);if(i != 3) sMask+=".";}return sMask;}function isMaskLen(sMaskLen){var nMaskLen = parseInt(sMaskLen, 10);return ((/^\d{1,2}$/.test(sMaskLen)) && nMaskLen > 0 && nMaskLen <= 32);}function isSeriatedottedQuadMask(sDottedQuadMask){return (sDottedQuadMask in aSeriateMask);}function fnCheckIPv4(sIPv4){return (isDottedQuad(sIPv4)&&(dottedQuadToNumber(sIPv4)>0));}function fnCheckMask(sMask, oOption){return (isDottedQuad(sMask)&&(!oOption.seriate_mask||isSeriatedottedQuadMask(sMask))&&(dottedQuadToNumber(sMask)>0));}function fnCheckMaskOrMaskLen(sMaskOrMaskLen){return (isDottedQuad(sMaskOrMaskLen)||isMaskLen(sMaskOrMaskLen));}function fnCheckIPv4Mask(sIPv4Mask, options){var aIPv4Mask = sIPv4Mask.split("/");var isValidIPv4 = fnCheckIPv4(aIPv4Mask[0]);var isValidMask = fnCheckMaskOrMaskLen(aIPv4Mask[1]);var isValid = isValidIPv4 && ((aIPv4Mask.length==1)|| isValidMask);if(isValid === false){return -1;}if(options){if(options.checkContinue === true){if(checkMaskContinue(aIPv4Mask[1]) === false) return -2;}}return 0;}function checkMaskContinue(sMask){var nMask = maskOrMaskLenToNumber(sMask);for ( var i = 1; i <= 32; i++ ){if(nMask == maskOrMaskLenToNumber(i-1)){return true;}}return false;}function maskOrMaskLenToNumber(sMask){	var nMask = maskLenToNumber("32");if(isMaskLen(sMask)){nMask = maskLenToNumber(sMask)}else if(isDottedQuad(sMask)){nMask = dottedQuadToNumber(sMask);}return nMask;}function netCover(sIpMask1, sIpMask2){var nIp1 = dottedQuadToNumber(sIpMask1.split("/")[0]);var nIp2 = dottedQuadToNumber(sIpMask2.split("/")[0]);var nMask1 = maskOrMaskLenToNumber(sIpMask1.split("/")[1]);var nMask2 = maskOrMaskLenToNumber(sIpMask2.split("/")[1]);var nMaskMin = Math.min(nMask1, nMask2);if((nIp1 & nMaskMin) == (nIp2 & nMaskMin)){if((nMask1-nMask2)==0){nReleation = 0;};if((nMask1-nMask2)<0){nReleation = 1;};if((nMask1-nMask2)>0){nReleation = -1;};}else nReleation = Number.NaN;return nReleation;}var aCheckMap = {IPv4Mask:{fnCheck:fnCheckIPv4Mask,sErrMsg:RS_ERR_IP4}};function check(sWtype, sValue, oOptionalOption) {if(null == sWtype || null == sValue){throw new Error("Parameter error!");}var oResult = {success:true, message:""};var oOption = {error_title:"", min:null, max:null, seriate_mask:true};for(var i in oOptionalOption) oOption[i] = oOptionalOption[i];var ret = aCheckMap[sWtype].fnCheck(sValue, oOption);oResult.success = (ret < 0 ? false : true);oResult.returnValue = ret;if(!oResult.success){if(oResult.returnValue == -1) oResult.message = RS_ERROR + RS_SEPERATOR + RS_ERR_IP4;if(oResult.returnValue == -2) oResult.message = RS_ERROR + RS_SEPERATOR + RS_ERR_SERIES_MASK_ERROR;}return oResult;}Util.check = check;Util.netCover = netCover;})();Util.DragDom = DragDom;Util.getWindowByElement = getWindowByElement;Util.FloatDiv = FloatDiv;Util.Cover = new Cover();Util.Tip = new Tip();Util.getOffsetTop = getOffsetTop;Util.getOffsetLeft = getOffsetLeft;Util.createElement = createElement;Util.createImage = createImage;Util.bindEvent = bindEvent;Util.contains = contains;Util.getType = getType;Util.ipToInteger = IpStr2Integer;Util.portToString = portToString;Util.makeFixLen = makeFixLen;Util.cookie = cookie;Util.Dot = Dot;Util.JSON = JSON;Util.Monitor = Monitor;})();